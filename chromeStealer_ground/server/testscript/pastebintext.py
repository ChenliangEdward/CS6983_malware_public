import requests

def create_paste(api_user_key, paste_code, paste_name):
    # API URL
    url = "https://pastebin.com/api/api_post.php"
    
    # Your API key here
    api_dev_key = 'jNz91HCPI_iMptdqNek5UhHcgRD0a1Oc'  # Replace this with your actual Pastebin Developer API key

    # Paste content and other parameters
    api_paste_code = paste_code  # Text to be pasted
    api_paste_private = '0'  # Visibility: 0=public, 1=unlisted, 2=private
    api_paste_name = paste_name # Name or title of the paste
    api_paste_expire_date = '10M'  # Paste expiration date
    api_paste_format = 'python'  # Syntax highlighting: Use 'python' for Python syntax
    
    # Payload for POST request
    data = {
        'api_option': 'paste',
        'api_paste_private': api_paste_private,
        'api_paste_name': api_paste_name,
        'api_paste_expire_date': api_paste_expire_date,
        'api_paste_format': api_paste_format,
        'api_dev_key': api_dev_key,
        'api_paste_code': api_paste_code
    }
    
    # Make the HTTP request
    response = requests.post(url, data=data)
    
    # Print the response URL or error message
    if response.status_code == 200:
        print("Paste created successfully: " + response.text)
    else:
        print(response.text)

def get_api_user_key(dev_key, username, password):
    url = "https://pastebin.com/api/api_login.php"
    data = {
        'api_dev_key': dev_key,
        'api_user_name': username,
        'api_user_password': password
    }

    try:
        response = requests.post(url, data=data)
        if response.status_code == 200:
            print("API User Key retrieved successfully!")
            return response.text  # This is the api_user_key
        else:
            print("Failed to retrieve API User Key. Status code:", response.status_code)
            print("Response:", response.text)
            return None
    except requests.exceptions.RequestException as e:
        print("An error occurred:", e)
        return None

def list_pastes(api_dev_key, api_user_key, limit=50):
    url = 'https://pastebin.com/api/api_post.php'
    data = {
        'api_option': 'list',
        'api_user_key': api_user_key,
        'api_dev_key': api_dev_key,
        'api_results_limit': limit
    }

    response = requests.post(url, data=data)
    if response.status_code == 200:
        return response.text
    else:
        return "Failed to retrieve pastes. Status code: {}".format(response.status_code)


# Replace the following variables with your actual data

username = 'cs6983coursedev1'
# username = 'a'
password = 'cs6983MalWare'


api_dev_key = '08CxUCxdpT_IYXzNo3-knf_df_76yUJX'  # Your Pastebin Developer API Key
api_user_key = '792b170053a0cd39023e520908cb42c1'
# Fetching the API User Key
api_user_key = get_api_user_key(api_dev_key, username, password)
if api_user_key:
    print("Your API User Key is:", api_user_key)
else:
    print("Could not obtain API User Key.")

# Call the function
create_paste(api_user_key, "sadfasdfklcjsakemrkcisle", "guid|url")

# Fetching the pastes
pastes = list_pastes(api_dev_key, api_user_key)

print(pastes)