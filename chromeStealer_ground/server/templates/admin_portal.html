<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Portal</title>
    <link rel="shortcut icon" href="{{ url_for('static', filename='images/favicon.ico') }}">
    <link rel= "stylesheet" type= "text/css" href= "{{ url_for('static',filename='styles/adminpage.css') }}">
</head>
<body>
    <div class="tab">
        <button class="tablinks" onclick="openTab(event, 'Implants')">Registered Implants</button>
        <button class="tablinks" onclick="openTab(event, 'HostDetails')">Host Details</button>
        <button class="tablinks" onclick="openTab(event, 'Tasks')">Tasks</button>
        <button class="tablinks" onclick="openTab(event, 'Shellcmd')">Shellcmd</button>
        <!-- <button class="tablinks" onclick="openTab(event, 'FileLoot')">File Loot</button> -->

    </div>

    <!-- Tab content for Registered Implants -->
    <div id="Implants" class="tabcontent">
        <h1>Registered Implants</h1>
        <ul>
            <li class="implant-title">
                <h3>GUID:</h3>
                <h3>Date registered:</h3>
                <h3>Last Connection:</h3>
            </li>
            {% for implant in registered_implants %}
            <li class="implant-item">
                <textarea rows="1" cols="40" class="form-control" readonly>{{ implant.client_guid }}</textarea>
                <textarea rows="1" cols="20" class="form-control" readonly>{{ implant.date_registered }} </textarea>
                <textarea rows="1" cols="20" class="form-control" readonly>{{ implant.last_connection }} </textarea>
            </li>
            {% endfor %}

        </ul>
    </div>

    <!-- Tab content for Registered Implants -->
    <div id="HostDetails" class="tabcontent">
        <h1>Host Details</h1>
        <ul>
            {% for info in infogathered %}
            <li class="host-detail-item">
                <textarea rows="1" cols="50" class="form-control" readonly>{{ info.client_guid }}</textarea>
                <textarea rows="1" cols="40" class="form-control" readonly>{{ info.date_logged }} </textarea>
                <textarea rows="5" cols="80" class="form-control" readonly>
                    {{ info.username }} 
                    {{ info.mem }} 
                    {{ info.devicename }}
                    {{ info.CPU }} 
                    {{ info.windows }} 
                </textarea>
            </li>
            {% endfor %}
        </ul>
    </div>
    <!-- Tab content for Tasks -->
    <div id="Tasks" class="tabcontent">
        <h1>Tasks</h1>

        <form id="taskForm" >
            <label for="Client">Choose a client:</label>
            <select name="client" id="client" class="form-control">
                {% for implant in registered_implants %}
                    <option value="{{ implant.client_guid }}">{{ implant.client_guid }}</option>
                {% endfor %}  
            </select>
            
            <label for="task">Choose a task:</label>
            <select name="task" id="task" class="form-control">
              <option value="0">IDLE</option>
              <option value="1">ADJUST_BEACON</option>
              <option value="3">TAUNT</option>
              <option value="4">HOWLER</option>
              <option value="5">INFOGATHER</option>
              <option value="6">CHROME</option>
              <option value="7">DOWNLOAD</option>
              <option value="8">UPLOAD</option>
              <option value="9">SHELLCMD</option>
              <option value="10">DISSOLVE</option>
              <!-- Add more tasks as needed -->
            </select>
            <br>
            <label for="args">Task Arguments:</label>
            <input type="text" size=100 id="args" name="args" class="form-control">  
            <button type="submit" class="button">Commit</button>
            
            <textarea rows="40" cols="150" class="form-control" readonly>
                {% for task in tasks %}
                    client_guid:{{ task.client_guid }} - Task:{{ task.current_task }} - args:{{ task.current_args }} - comment: {{ task.comment }} - time: {{ task.date_commited}}
                {% endfor %}
            </textarea>
        </form>
    </div>

    <!-- Tab content for Shellcmd -->
    <div id="Shellcmd" class="tabcontent">
        <h1>Shell command result</h1>
        <form id="shellcmd" >
            <label for="Implant">Implant/Command:</label>
            <select name="implant_list" id="implant_list" class="form-control">
                {% for shellcmd in shellcmds %}
                <option data-id="{{ shellcmd.id }}" data-guid="{{ shellcmd.client_guid }}" data-command="{{ shellcmd.command_executed }}" id="commandlist">
                    GUID : {{ shellcmd.client_guid }} command: {{shellcmd.command_executed}} id: {{shellcmd.id}}
                </option>
                {% endfor %}
            </select>
            <br>
            <label for="result">Result:</label>
            <textarea id="result" name="result" rows="40" cols="100" class="form-control" readonly></textarea>
        </form>
    </div>
<!--     
    <div id="FileLoot"  class="tabcontent">
        <h1>File Uploaded By Implant</h1>

    </div> -->
</body>
<script src="{{ url_for('static',filename='scripts/scripts.js') }}"> </script>
<script>

</script>
</html>